---
title: "TP1 Econometría Avanzada"
author: "Casiano, Denys; Daboin, Carlos y Quispe, Anzony"
date: "`r Sys.Date()`"
geometry: "left=2.5cm,right=2.5cm,top=1.5cm,bottom=2cm"
output: 
  pdf_document :
    keep_tex: true
    number_sections: false

header-includes:
 \usepackage{booktabs}
 \usepackage{longtable}
 \usepackage{array}
 \usepackage{multirow}
 \usepackage{wrapfig}
 \usepackage{float}
 \floatplacement{figure}{H}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, 
                      warning = FALSE,
                      message = FALSE)

# 0.0 install required packages -------------------------------------------
# install packages not installed

list.of.packages <- c("readr", "dplyr", "tidyr")
new.packages <- list.of.packages[!(list.of.packages %in% installed.packages()[,"Package"])]
if(length(new.packages)) install.packages(new.packages)

# 0.1 Load packages -------------------------------------------------------
library(readr)
library(dplyr)
library(tidyr)
library(jtools)   #para las tablas de regresion
```

## 1. Discusion del estimador between

*Discuta el modelo estimado (comente acerca de la validez del estimador between y potenciales sesgos) y comente los resultados obtenidos, en particular para las variables de justicia criminal.*

```{r}
# usa el comando export_summs del paquete jtools
# export_summs(model)

```


## 2. Posibles problemas de heterogeneidad no observable

*Explique por qué es muy posible que la presencia de heterogeneidad no observable a nivel de condado haga que las estimaciones anteriores sean sesgadas. *   

Dos condados pueden ser diferentes en *confounders* no-observables (confounders son variables correlacionadas con la variable dependiente y las variables explicativas.) 

Por ejemplo, es plausible que haya distintas tasas de reporte del crimen entre distintos condados, lo cual es inchequeable ya que las denuncias son la unica manera de medir el crimen. De ser esto cierto, aquellos condados similares a los demas en todas las caracteristicas observables pero con altas tasas de subreporte tendran (en promedio) una menor tasa de criminalidad y mayores tasas de arresto, lo que sesgaria la estimacion del efecto de las tasas de arresto sobre la criminalidad, haciendolo parecer de mayor magnitud.    

*Realice una estimación con efectos fijos por condado.*    

*Discuta por qué esta alternativa resolvería el problema de sesgo. *    
Un estimador de efectos fijos estaria exento de toda la variabilidad atribuible a los condados, por lo que se esta controlando por todos los no-observables que varian en este nivel. 

Acerca del ejemplo anterior, un estimador de efectos fijos (tambien llamado *within*) hubiese corregido las bajas tasas de criminalidad y las altas tasas de arresto de nuestros condados con alto subreporte, haciendolos comparables al resto.

*Testee formalmente la hipótesis nula de ausencia de efectos fijos. *

CD: Deberiamos comparar los estimadores del modelo between con los estimadores del modelo de efecto fijo usando el test de Hausmann.

El test de especificacion de Hausman sirve para detectar si hay algun problema de heterogeneidad no observada, o variables omitidas, en nuestra especificacion.

La hipotesis nula del test de Hausman es que matriz de variables omitidas es ortogonal a la matriz de variables incluidas en el modelo.
$$
H0: D\mu  \perp X
$$
$$
H1: D\mu  \perp X
$$
La hipotesis tiene mayores chances de ser rechazada a medida que la diferencia entre $\hat\beta_{FE}$ y $\hat\beta_{BE}$ es mayor. 

Se rechaza la hipotesis nula, confirmando que la espeficacion del modelo between padece de sesgo por efectos fijos omitidos.


*A la luz del trabajo de CyT, discuta las principales diferencias encontradas con las estimaciones anteriores.*


# 3. Probando el estimador de efectos aleatorios
*Estime el modelo usando un estimador de efectos aleatorios. *    



*Implemente un test de Hausman para comparar los estimadores de efectos fijos y de efectos aleatorios y comente los resultados obtenidos*   

Seguramente encontraremos que el modelo esta mal especificado sin los efectos fijos, por la misma razon que en la pregunta 2. En este el estimador de RE, si bien es eficiente en datos de panel, esta sesgado por omitir controles relevantes.

# 4. Comparando resultados

# 5. Comentarios sobre la presencia de efectos aleatorios y correlacion serial de primer orden

*Evalúe con distintos tests la presencia de posibles efectos aleatorios y correlación serial de primer orden.*
CD: No entiendo esta pregunta. Estan pidiendo que hagamos un test de autocorrelacion sobre los residuos de un OLS?


*En particular, comente intuitivamente qué es lo que sugiere el resultado correspondiente al test de autocorrelación.*


CD:
Esto es lo que se: Si hay autocorrelacion en datos de panel, entonces OLS es ineficiente, y conviene usar RE.

Sin embargo, no conviene usar RE cuendo el se rechaza la hipotesis nula del test de Hausman: es decir, cuando hay una matriz de efectos fijos que es ortogonal a las variables explicativas. En ese caso conviene una especificacion de efectos fijos con errores estandar robustos (algo que aun no hemos visto en la clase.) La idea de aplicar errores estandar robustos es ajustar hacia arriba los errores estandar de $\beta$, porque estos estan subestimados cuando hay autocorrelacion de los errores. (Tomar con pinza y confirmar todo esto de los robust std. errors).